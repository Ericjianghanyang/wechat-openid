<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾®ä¿¡ OpenID ç²å–ç³»çµ±</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #007bff;
        }
        .step {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .step h3 {
            color: #007bff;
            margin-top: 0;
        }
        .btn {
            background-color: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin: 10px;
            font-size: 16px;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .btn-success {
            background-color: #28a745;
        }
        .btn-success:hover {
            background-color: #218838;
        }
        .btn-warning {
            background-color: #ffc107;
            color: #212529;
        }
        .btn-warning:hover {
            background-color: #e0a800;
        }
        .info-box {
            background-color: #e7f3ff;
            border: 1px solid #b8daff;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .warning-box {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .success-box {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
            margin: 10px 0;
            font-size: 12px;
        }
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .status-success {
            background-color: #28a745;
            color: white;
        }
        .status-warning {
            background-color: #ffc107;
            color: #212529;
        }
        .status-error {
            background-color: #dc3545;
            color: white;
        }
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .tool-card {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            background-color: white;
        }
        .tool-card h4 {
            margin-top: 0;
            color: #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>å¾®ä¿¡ OpenID ç²å–ç³»çµ±</h1>
            <p>å®Œæ•´çš„å¾®ä¿¡ç¶²é æˆæ¬Šè§£æ±ºæ–¹æ¡ˆ</p>
        </div>

        <div class="step">
            <h3>ğŸ“‹ ç³»çµ±ç‹€æ…‹æª¢æŸ¥</h3>
            <div class="info-box">
                <p><strong>åŸŸåï¼š</strong> openid.meditechmacao.com <span class="status status-success">å·²é…ç½®</span></p>
                <p><strong>éƒ¨ç½²å¹³å°ï¼š</strong> Vercel <span class="status status-success">å·²éƒ¨ç½²</span></p>
                <p><strong>HTTPSï¼š</strong> å·²å•Ÿç”¨ <span class="status status-success">å®‰å…¨</span></p>
                <p><strong>å¾®ä¿¡å…¬çœ¾è™Ÿï¼š</strong> wxe877716401fdb4c9 <span class="status status-warning">éœ€é…ç½®</span></p>
            </div>
        </div>

        <div class="step">
            <h3>ğŸ”§ ç¬¬ä¸€æ­¥ï¼šå¾®ä¿¡å…¬çœ¾å¹³å°é…ç½®</h3>
            <div class="warning-box">
                <h4>é‡è¦æé†’ï¼š</h4>
                <ul>
                    <li>ç¢ºä¿æ‚¨çš„å…¬çœ¾è™Ÿæ˜¯<strong>æœå‹™è™Ÿ</strong>ä¸”<strong>å·²èªè­‰</strong></li>
                    <li>è¨‚é–±è™ŸåŠŸèƒ½å—é™ï¼Œå¯èƒ½ç„¡æ³•æ­£å¸¸ä½¿ç”¨ç¶²é æˆæ¬Š</li>
                </ul>
            </div>
            
            <h4>1.1 è¨­ç½®ç¶²é æˆæ¬ŠåŸŸå</h4>
            <ol>
                <li>ç™»éŒ„å¾®ä¿¡å…¬çœ¾å¹³å°</li>
                <li>é€²å…¥ã€Œè¨­ç½®ã€â†’ã€Œå…¬çœ¾è™Ÿè¨­ç½®ã€â†’ã€ŒåŠŸèƒ½è¨­ç½®ã€</li>
                <li>åœ¨ã€Œç¶²é æˆæ¬ŠåŸŸåã€ä¸­å¡«å…¥ï¼š<code>openid.meditechmacao.com</code></li>
                <li>æŒ‰ç…§æŒ‡ç¤ºä¸Šå‚³é©—è­‰æ–‡ä»¶åˆ°ç¶²ç«™æ ¹ç›®éŒ„</li>
            </ol>

            <h4>1.2 å‰µå»ºè‡ªå®šç¾©èœå–®</h4>
            <ol>
                <li>é€²å…¥ã€Œè‡ªå®šç¾©èœå–®ã€è¨­ç½®é é¢</li>
                <li>æ·»åŠ æ–°èœå–®é …ï¼Œé¸æ“‡ã€Œè·³è½‰ç¶²é ã€é¡å‹</li>
                <li>ä½¿ç”¨ä¸‹é¢çš„å·¥å…·ç”Ÿæˆæˆæ¬Š URL</li>
            </ol>
        </div>

        <div class="step">
            <h3>ğŸ› ï¸ ç¬¬äºŒæ­¥ï¼šä½¿ç”¨å·¥å…·ç”Ÿæˆæˆæ¬Š URL</h3>
            <div class="tools-grid">
                <div class="tool-card">
                    <h4>æˆæ¬Š URL ç”Ÿæˆå™¨</h4>
                    <p>ç”Ÿæˆæ¨™æº–çš„å¾®ä¿¡æˆæ¬Š URLï¼ŒåŒ…å«æ­£ç¢ºçš„ URL ç·¨ç¢¼</p>
                    <a href="/auth-url-generator.html" class="btn">æ‰“é–‹ç”Ÿæˆå™¨</a>
                </div>
                <div class="tool-card">
                    <h4>URL ç·¨ç¢¼æ¸¬è©¦</h4>
                    <p>æ¸¬è©¦ä¸åŒçš„ URL ç·¨ç¢¼æ–¹å¼ï¼Œç¢ºä¿æ ¼å¼æ­£ç¢º</p>
                    <a href="/url-encoding-test.html" class="btn">æ‰“é–‹æ¸¬è©¦å·¥å…·</a>
                </div>
            </div>
        </div>

        <div class="step">
            <h3>ğŸ“± ç¬¬ä¸‰æ­¥ï¼šæ¸¬è©¦æˆæ¬Šæµç¨‹</h3>
            <div class="info-box">
                <h4>æ¨™æº–æˆæ¬Š URL æ ¼å¼ï¼š</h4>
                <div class="code-block">https://open.weixin.qq.com/connect/oauth2/authorize?appid=YOUR_APPID&redirect_uri=YOUR_REDIRECT_URL&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect</div>
            </div>

            <h4>æ¸¬è©¦æ­¥é©Ÿï¼š</h4>
            <ol>
                <li>ä½¿ç”¨å·¥å…·ç”Ÿæˆæˆæ¬Š URL</li>
                <li>å°‡ URL è¨­ç½®åˆ°å¾®ä¿¡å…¬çœ¾å¹³å°è‡ªå®šç¾©èœå–®</li>
                <li><strong>åœ¨æ‰‹æ©Ÿå¾®ä¿¡ä¸­é»æ“Šèœå–®</strong>ï¼ˆé‡è¦ï¼šä¸è¦ç”¨é›»è…¦ç€è¦½å™¨ï¼‰</li>
                <li>ç¢ºèªæˆæ¬Šå¾Œæœƒè·³è½‰åˆ° callback é é¢</li>
                <li>æŸ¥çœ‹ç²å–çš„ç”¨æˆ¶ä¿¡æ¯</li>
            </ol>

            <div class="warning-box">
                <h4>å¸¸è¦‹å•é¡Œï¼š</h4>
                <ul>
                    <li><strong>404 éŒ¯èª¤ï¼š</strong>æª¢æŸ¥ç¶²é æˆæ¬ŠåŸŸåæ˜¯å¦æ­£ç¢ºé…ç½®</li>
                    <li><strong>ç©ºç™½é é¢ï¼š</strong>ç¢ºä¿ callback é é¢èƒ½æ­£å¸¸è¨ªå•</li>
                    <li><strong>æˆæ¬Šå¤±æ•—ï¼š</strong>ç¢ºèªå…¬çœ¾è™Ÿé¡å‹å’Œèªè­‰ç‹€æ…‹</li>
                </ul>
            </div>
        </div>

        <div class="step">
            <h3>ğŸ” ç¬¬å››æ­¥ï¼šèª¿è©¦å’Œç›£æ§</h3>
            <div class="tools-grid">
                <div class="tool-card">
                    <h4>æˆæ¬Šå›èª¿è™•ç†</h4>
                    <p>è™•ç†å¾®ä¿¡æˆæ¬Šå›èª¿ï¼Œç²å–ç”¨æˆ¶ä¿¡æ¯</p>
                    <a href="/callback.html" class="btn">æŸ¥çœ‹å›èª¿é é¢</a>
                </div>
                <div class="tool-card">
                    <h4>ç’°å¢ƒè®Šé‡æª¢æŸ¥</h4>
                    <p>æª¢æŸ¥æœå‹™å™¨é…ç½®æ˜¯å¦æ­£ç¢º</p>
                    <a href="/api/debug/env" class="btn">æª¢æŸ¥é…ç½®</a>
                </div>
            </div>
        </div>

        <div class="step">
            <h3>ğŸ“š æŠ€è¡“æ–‡æª”</h3>
            <div class="info-box">
                <h4>API ç«¯é»ï¼š</h4>
                <ul>
                    <li><strong>æˆæ¬Šè™•ç†ï¼š</strong> <code>POST /api/wechat/process-auth</code></li>
                    <li><strong>ç’°å¢ƒæª¢æŸ¥ï¼š</strong> <code>GET /api/debug/env</code></li>
                </ul>
            </div>

            <h4>é‡è¦æ–‡ä»¶ï¼š</h4>
            <ul>
                <li><code>public/callback.html</code> - æˆæ¬Šå›èª¿è™•ç†é é¢</li>
                <li><code>api/wechat/process-auth.js</code> - å¾Œç«¯æˆæ¬Šè™•ç† API</li>
                <li><code>public/auth-url-generator.html</code> - æˆæ¬Š URL ç”Ÿæˆå™¨</li>
            </ul>
        </div>

        <div class="step">
            <h3>âœ… å®Œæˆæª¢æŸ¥æ¸…å–®</h3>
            <div class="success-box">
                <h4>è«‹ç¢ºèªä»¥ä¸‹é …ç›®ï¼š</h4>
                <ul>
                    <li>âœ… åŸŸåå·²é…ç½®ä¸¦å¯è¨ªå•</li>
                    <li>âœ… HTTPS å·²å•Ÿç”¨</li>
                    <li>âœ… å¾®ä¿¡å…¬çœ¾è™Ÿ AppID å·²è¨­ç½®</li>
                    <li>âœ… ç¶²é æˆæ¬ŠåŸŸåå·²é…ç½®</li>
                    <li>âœ… è‡ªå®šç¾©èœå–®å·²è¨­ç½®</li>
                    <li>âœ… åœ¨æ‰‹æ©Ÿå¾®ä¿¡ä¸­æ¸¬è©¦é€šé</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // æª¢æŸ¥ç³»çµ±ç‹€æ…‹
        async function checkSystemStatus() {
            try {
                const response = await fetch('/api/debug/env');
                const data = await response.json();
                console.log('ç³»çµ±é…ç½®:', data);
            } catch (error) {
                console.error('æª¢æŸ¥ç³»çµ±ç‹€æ…‹å¤±æ•—:', error);
            }
        }

        // é é¢åŠ è¼‰æ™‚æª¢æŸ¥ç‹€æ…‹
        document.addEventListener('DOMContentLoaded', checkSystemStatus);
    </script>
</body>
</html> 